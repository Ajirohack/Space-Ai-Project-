!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="8b281324-49df-4fa6-8f83-46982d2a10e1",e._sentryDebugIdIdentifier="sentry-dbid-8b281324-49df-4fa6-8f83-46982d2a10e1")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7940],{6465:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/settings/storage",function(){return s(81401)}])},66344:function(e,t,s){"use strict";s.d(t,{Q:function(){return i}});var n=s(97458),a=s(59630),r=s(35772),l=s(94821),i=e=>{let{page:t,menu:s}=e;return(0,n.jsx)("div",{className:"flex flex-col space-y-8 overflow-y-auto","data-sentry-component":"ProductMenu","data-sentry-source-file":"ProductMenu.tsx",children:(0,n.jsx)(a.ZP,{type:"pills","data-sentry-element":"Menu","data-sentry-source-file":"ProductMenu.tsx",children:s.map((e,i)=>(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"my-6 space-y-8",children:(0,n.jsxs)("div",{className:"mx-3",children:[(0,n.jsx)(a.ZP.Group,{title:e.title?(0,n.jsxs)("div",{className:"flex flex-col space-y-2 uppercase font-mono",children:[(0,n.jsx)("span",{children:e.title}),e.isPreview&&(0,n.jsx)(r.C,{variant:"warning",children:"Not production ready"})]}):null}),(0,n.jsx)("div",{children:e.items.map(e=>{let s=e.pages?e.pages.includes(t):t===e.key;return(0,n.jsx)(l.Z,{url:e.url,name:e.name,icon:e.icon,rightIcon:e.rightIcon,isActive:s,isExternal:e.isExternal,target:e.isExternal?"_blank":"_self",label:e.label},e.key)})})]})}),i!==s.length-1&&(0,n.jsx)("div",{className:"h-px w-full bg-border-overlay"})]},e.key||e.title))})})}},26713:function(e,t,s){"use strict";s.d(t,{Z:function(){return h}});var n=s(97458),a=s(82943),r=s(52983),l=s(54580),i=s(66344),o=s(26950),c=s(7611),d=s(14612),u=s(87358),f=s(55861),x=s(73614),m=s(67236),p=s(83427);let y=(e,t,s,a)=>{var r,l,i,o;let c=(null==t?void 0:t.status)===x.S.COMING_UP,d="/project/".concat(e),u=null===(r=null==a?void 0:a.auth)||void 0===r||r,f=null===(l=null==a?void 0:a.edgeFunctions)||void 0===l||l,m=null===(i=null==a?void 0:a.storage)||void 0===i||i,y=null!==(o=null==a?void 0:a.diskAndCompute)&&void 0!==o&&o;return[{title:"Project Settings",items:[{name:"General",key:"general",url:"/project/".concat(e,"/settings/general"),items:[]},...x.Qy&&y?[{name:"Compute and Disk",key:"compute-and-disk",url:"/project/".concat(e,"/settings/compute-and-disk"),items:[]}]:[],{name:"Infrastructure",key:"infrastructure",url:c?d:"/project/".concat(e,"/settings/infrastructure"),items:[]},...x.Qy?[{name:"Integrations",key:"integrations",url:"/project/".concat(e,"/settings/integrations"),items:[]},...(null==a?void 0:a.newApiKeys)?[{name:"API Keys",key:"api-keys",url:"/project/".concat(e,"/settings/api-keys"),items:[],label:"NEW"}]:[]]:[],{name:"Add Ons",key:"addons",url:"/project/".concat(e,"/settings/addons"),items:[]},{name:"Vault",key:"vault",url:c?d:"/project/".concat(e,"/integrations/vault/overview"),items:[],rightIcon:(0,n.jsx)(p.Z,{strokeWidth:1,className:"h-4 w-4"}),label:"Alpha"}]},{title:"Configuration",items:[{name:"Database",key:"database",url:c?d:"/project/".concat(e,"/settings/database"),items:[]},{name:"Data API",key:"api",url:c?d:"/project/".concat(e,"/settings/api"),items:[]},...x.Qy&&u?[{name:"Authentication",key:"auth",url:c?d:"/project/".concat(e,"/settings/auth"),items:[]}]:[],...x.Qy&&m?[{name:"Storage",key:"storage",url:"/project/".concat(e,"/settings/storage"),items:[]}]:[],...x.Qy&&f?[{name:"Edge Functions",key:"functions",url:"/project/".concat(e,"/functions/secrets"),items:[],rightIcon:(0,n.jsx)(p.Z,{strokeWidth:1,className:"h-4 w-4"})}]:[],...x.Qy?[{name:"Log Drains",key:"log-drains",url:"/project/".concat(e,"/settings/log-drains"),items:[]}]:[]]},{title:"Billing",items:[{name:"Subscription",key:"subscription",url:"/org/".concat(null==s?void 0:s.slug,"/billing"),items:[]},{name:"Usage",key:"usage",url:"/org/".concat(null==s?void 0:s.slug,"/usage?projectRef=").concat(e),items:[]}]}]};var h=(0,u.Q)(e=>{let{title:t,children:s}=e,u=(0,a.useRouter)(),{ref:p}=(0,l.UO)(),h=(0,d.Vm)(),g=(0,c.l)();(0,r.useEffect)(()=>{x.Qy||u.push("/project/default")},[u]);let j=u.pathname.includes("billing")?u.pathname.split("/")[5]:u.pathname.split("/")[4],{projectAuthAll:v,projectEdgeFunctionAll:N,projectStorageAll:S,billingInvoices:C}=(0,o.N)(["project_auth:all","project_edge_function:all","project_storage:all","billing:invoices"]),b=y(p,h,g,{auth:v,edgeFunctions:N,storage:S,invoices:C,diskAndCompute:(0,f.P)("diskAndComputeForm"),newApiKeys:(0,f.P)("newApiKeys")});return(0,n.jsx)(m.Z,{isBlocking:!1,title:t||"Settings",product:"Settings",productMenu:(0,n.jsx)(i.Q,{page:j,menu:b}),"data-sentry-element":"ProjectLayout","data-sentry-component":"SettingsLayout","data-sentry-source-file":"SettingsLayout.tsx",children:s})})},97847:function(e,t,s){"use strict";s.d(t,{CG:function(){return S},FW:function(){return f},I7:function(){return m},Lc:function(){return g},RN:function(){return y},Wv:function(){return v},_S:function(){return c},g$:function(){return h},gW:function(){return C},jX:function(){return x},q7:function(){return u},qw:function(){return p},s_:function(){return o},tM:function(){return j},tU:function(){return d},ur:function(){return N},y:function(){return i}});var n=s(97458),a=s(52983),r=s(21513),l=s(53355);let i="mx-auto w-full max-w-[1200px]",o="px-4 md:px-6 lg:px-14 xl:px-24 2xl:px-28",c=(0,a.forwardRef)((e,t)=>{let{className:s,bottomPadding:a,size:i="default",...c}=e,d=(0,r.oJ)();return(0,n.jsx)("div",{ref:t,...c,className:(0,l.cn)("mx-auto w-full",{small:"max-w-[768px]",default:"max-w-[1200px]",large:"max-w-[1600px]",full:"max-w-none"}[i],o,a&&"pb-16",d.open?"xl:px-6":"",s)})}),d=(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("header",{...a,ref:t,className:(0,l.cn)("w-full","flex-col gap-3 py-6",s)})}),u=(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("h1",{ref:t,...a,className:(0,l.cn)("text-2xl",s)})}),f=(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("p",{ref:t,...a,className:(0,l.cn)("text-sm text-foreground-light",s)})}),x=(0,a.forwardRef)((e,t)=>{let{className:s,isFullWidth:a,topPadding:r,...i}=e;return(0,n.jsx)("div",{ref:t,...i,className:(0,l.cn)("flex flex-col first:pt-12 py-6",a?"w-full":"gap-3 lg:grid md:grid-cols-12",s)})}),m=(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,...a,className:(0,l.cn)("w-full h-px bg-border",s)})}),p=(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("h3",{ref:t,...a,className:(0,l.cn)("text-foreground text-xl",s)})}),y=(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("p",{ref:t,...a,className:(0,l.cn)("text-sm text-foreground-light",s)})}),h=(0,a.forwardRef)((e,t)=>{let{className:s,children:a,title:r,...i}=e;return(0,n.jsxs)("div",{ref:t,...i,className:(0,l.cn)("col-span-4 xl:col-span-5 prose text-sm",s),children:[r&&(0,n.jsx)("h2",{children:r}),a]})}),g=(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,...a,className:(0,l.cn)("col-span-8 xl:col-span-7","flex flex-col gap-6",s)})}),j=(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,...a,className:(0,l.cn)("flex flex-col gap-3 items-center",s)})}),v=(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,...a,className:(0,l.cn)("flex w-full items-center",s)})}),N=(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,...a,className:(0,l.cn)("flex flex-row gap-3",s)})}),S=(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,...a,className:(0,l.cn)("flex flex-col gap-3","min-w-[420px]",s)})}),C=(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,...a,className:(0,l.cn)(i,o,"my-8 flex flex-col gap-8",s)})});d.displayName="ScaffoldHeader",u.displayName="ScaffoldTitle",f.displayName="ScaffoldDescription",c.displayName="ScaffoldContainer",m.displayName="ScaffoldDivider",x.displayName="ScaffoldSection",S.displayName="ScaffoldColumn",h.displayName="ScaffoldSectionDetail",g.displayName="ScaffoldSectionContent",j.displayName="ScaffoldFilterAndContent",v.displayName="ScaffoldActionsContainer",N.displayName="ScaffoldActionsGroup",C.displayName="ScaffoldContainerLegacy",p.displayName="ScaffoldSectionTitle",y.displayName="ScaffoldSectionDescription"},18904:function(e,t,s){"use strict";var n=s(97458),a=s(87699),r=s(35389),l=s(52983),i=s(9618),o=s(94997),c=s(53355);t.Z=e=>{var t;let{text:s,asyncText:d,iconOnly:u=!1,children:f,onClick:x,copyLabel:m="Copy",copiedLabel:p="Copied",...y}=e,[h,g]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{if(!h)return;let e=setTimeout(()=>g(!1),2e3);return()=>clearTimeout(e)},[h]),(0,n.jsx)(o.z,{onClick:async e=>{let t=d?await d():s;g(!0),await (0,i.vQ)(t),null==x||x(e)},...y,className:(0,c.cn)({"px-1":u},y.className),icon:h?(0,n.jsx)(a.Z,{strokeWidth:2,className:"text-brand"}):null!==(t=y.icon)&&void 0!==t?t:(0,n.jsx)(r.Z,{}),"data-sentry-element":"Button","data-sentry-component":"CopyButton","data-sentry-source-file":"CopyButton.tsx",children:!u&&(0,n.jsx)(n.Fragment,{children:null!=f?f:h?p:m})})}},10830:function(e,t,s){"use strict";s.d(t,{p:function(){return l}});var n=s(97458),a=s(53355),r=s(9846);let l=e=>{let{title:t,description:s,docsUrl:l,actions:i,className:o}=e;return(0,n.jsxs)("div",{className:(0,a.cn)("w-full mb-6 flex flex-col sm:flex-row md:items-center justify-between gap-4 ".concat(o)),"data-sentry-component":"FormHeader","data-sentry-source-file":"FormHeader.tsx",children:[(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)("h3",{className:"text-foreground text-xl prose",children:t}),s&&(0,n.jsx)("div",{className:"prose text-sm max-w-full",children:s})]}),(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row md:items-center gap-x-2",children:[void 0!==l&&(0,n.jsx)(r.G,{href:l}),i]})]})}},94821:function(e,t,s){"use strict";var n=s(97458),a=s(89462),r=s.n(a),l=s(59630),i=s(35772),o=s(94997);t.Z=e=>{let{name:t="",isActive:s,isExternal:a,icon:c,rightIcon:d,url:u="",target:f="_self",onClick:x,textClassName:m="",hoverText:p="",label:y}=e,h=(0,n.jsx)(l.ZP.Item,{icon:c,rounded:!0,active:s,onClick:x,children:(0,n.jsxs)("div",{className:"flex w-full items-center justify-between gap-1",children:[(0,n.jsxs)("div",{title:p||("string"==typeof t?t:""),className:"flex items-center gap-2 truncate w-full "+m,children:[(0,n.jsxs)("span",{className:"truncate",children:[t," "]}),void 0!==y&&(0,n.jsx)(i.C,{variant:"warning",className:"py-0 px-1.5 capitalize",children:y})]}),d&&(0,n.jsx)("div",{children:d})]})});return u?a?(0,n.jsx)(o.z,{asChild:!0,block:!0,className:"!justify-start",type:"text",size:"small",icon:c,children:(0,n.jsx)(r(),{href:u,target:"_blank",rel:"noreferrer",children:t})}):(0,n.jsx)(r(),{href:u,className:"block",target:f,children:h}):h}},81401:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return eo}});var n=s(97458),a=s(51164),r=s(26713),l=s(97847),i=s(67422),o=s(52585),c=s(40540),d=s(8607),u=s(89462),f=s.n(u),x=s(52983),m=s(86848),p=s(34549),y=s(5394),h=s(54580),g=s(41888),j=s(3558),v=s(19851),N=s(10830),S=s(50918),C=s(91371),b=s(37610),k=s(9237),w=s(86564),R=s(28894),_=s(64472);let D=e=>["projects",e,"storage-credentials"];var I=s(73614);async function A(e,t){let{projectRef:s}=e;if(!s)throw Error("projectRef is required");let{data:n,error:a}=await (0,_.U2)("/platform/storage/{ref}/credentials",{params:{path:{ref:s}},signal:t});return a&&(0,_.S3)(a),n}let E=function(e){let{projectRef:t}=e,{enabled:s=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,R.a)(D(t),e=>{let{signal:s}=e;return A({projectRef:t},s)},{enabled:s&&I.Qy&&void 0!==t,...n})};var M=s(29375),Z=s(1006),F=s(94823),T=s(65422),z=s(94997),P=s(82634),O=s(85573),L=s(11644),W=s(23522),Q=s(36457),B=s(64618);let K=async e=>{let{description:t,projectRef:s}=e;if(!s)throw Error("projectRef is required");let{data:n,error:a}=await (0,_.v_)("/platform/storage/{ref}/credentials",{params:{path:{ref:s}},body:{description:t}});return a&&(0,_.S3)(a),n};var q=s(17741),V=s(54888);let X=e=>{let{visible:t,onOpenChange:s}=e,{ref:a}=(0,h.UO)(),r=(0,g.gY)(),[l,i]=(0,x.useState)(!1),d=(0,M.Xo)(c.KA.STORAGE_ADMIN_WRITE,"*"),{data:u}=(0,k.k)({projectRef:a}),f=null==u?void 0:u.features.s3Protocol.enabled,j=!r||!d||!f,v=y.z.object({description:y.z.string().min(3,{message:"Description must be at least 3 characters long"})}),N=(0,m.cI)({resolver:(0,o.F)(v),defaultValues:{description:""}}),{data:S,mutate:C,isLoading:b}=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,Q.NL)();return(0,B.D)(e=>K(e),{async onSuccess(t,s,a){let{projectRef:r}=s;await n.invalidateQueries(D(r)),await (null==e?void 0:e(t,s,a))},async onError(e,s,n){void 0===t?p.Am.error("Failed to create S3 access key: ".concat(e.message)):t(e,s,n)},...s})}({onSuccess:()=>{i(!0),N.reset()}});async function w(e){C({projectRef:a,...e})}return(0,n.jsxs)(q.Vq,{open:t,onOpenChange:e=>{s(e),e||i(!1)},"data-sentry-element":"Dialog","data-sentry-component":"CreateCredentialModal","data-sentry-source-file":"CreateCredentialModal.tsx",children:[(0,n.jsxs)(V.u,{"data-sentry-element":"Tooltip","data-sentry-source-file":"CreateCredentialModal.tsx",children:[(0,n.jsx)(V.aJ,{asChild:!0,"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"CreateCredentialModal.tsx",children:(0,n.jsx)(q.hg,{asChild:!0,"data-sentry-element":"DialogTrigger","data-sentry-source-file":"CreateCredentialModal.tsx",children:(0,n.jsx)(z.z,{type:"default",disabled:j,className:"pointer-events-auto","data-sentry-element":"Button","data-sentry-source-file":"CreateCredentialModal.tsx",children:"New access key"})})}),j&&(0,n.jsx)(V._v,{side:"bottom",children:r?f?d?"":"You need additional permissions to create new access keys":"Connection via S3 protocol is currently disabled":"Restore your project to create new access keys"})]}),(0,n.jsx)(q.cZ,{onInteractOutside:e=>{l&&e.preventDefault()},"data-sentry-element":"DialogContent","data-sentry-source-file":"CreateCredentialModal.tsx",children:l?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(q.fK,{children:[(0,n.jsx)(q.$N,{children:"Save your new S3 access keys"}),(0,n.jsx)(q.Be,{children:"You won't be able to see them again. If you lose these access keys, you'll need to create a new ones."})]}),(0,n.jsx)(q.P3,{}),(0,n.jsxs)(q.VO,{className:"flex flex-col gap-4",children:[(0,n.jsx)(L.E,{label:"Access key ID",isReactForm:!1,children:(0,n.jsx)(O.I,{className:"input-mono",readOnly:!0,copy:!0,disabled:!0,value:null==S?void 0:S.access_key})}),(0,n.jsx)(L.E,{label:"Secret access key",isReactForm:!1,children:(0,n.jsx)(O.I,{className:"input-mono",readOnly:!0,copy:!0,disabled:!0,value:null==S?void 0:S.secret_key})})]}),(0,n.jsx)(q.cN,{children:(0,n.jsx)(z.z,{onClick:()=>{s(!1),i(!1)},children:"Done"})})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(q.fK,{children:[(0,n.jsx)(q.$N,{children:"Create new S3 access keys"}),(0,n.jsx)(q.Be,{children:"S3 access keys provide full access to all S3 operations across all buckets and bypass any existing RLS policies."})]}),(0,n.jsx)(q.P3,{}),(0,n.jsx)(Z.l0,{...N,children:(0,n.jsxs)("form",{onSubmit:N.handleSubmit(w),children:[(0,n.jsx)(q.VO,{children:(0,n.jsx)(Z.Wi,{name:"description",render:()=>(0,n.jsx)(L.E,{label:"Description",children:(0,n.jsx)(O.I,{autoComplete:"off",placeholder:"My test key",type:"text",...N.register("description")})})})}),(0,n.jsx)(q.cN,{children:(0,n.jsx)(z.z,{htmlType:"submit",loading:b,children:"Create access key"})})]})})]})})]})},G=async e=>{let{projectRef:t,id:s}=e;if(!t||!s)throw Error("projectRef and id are required");let{data:n,error:a}=await (0,_.IV)("/platform/storage/{ref}/credentials/{id}",{params:{path:{ref:t,id:s}}});return a&&"Failed to delete project storage credential"!==a.message&&(0,_.S3)(a),n},U=e=>{let{visible:t,selectedCredential:s,onClose:a}=e,{ref:r}=(0,h.UO)(),{mutate:l,isLoading:i}=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,Q.NL)();return(0,B.D)(e=>G(e),{async onSuccess(t,s,a){let{projectRef:r}=s;await n.invalidateQueries(D(r)),await (null==e?void 0:e(t,s,a))},async onError(e,s,n){void 0===t?p.Am.error("Failed to delete S3 access key: ".concat(e.message)):t(e,s,n)},...s})}({onSuccess:()=>{p.Am.success("Successfully revoked S3 access key"),a()}});return(0,n.jsx)(q.Vq,{open:t,"data-sentry-element":"Dialog","data-sentry-component":"RevokeCredentialModal","data-sentry-source-file":"RevokeCredentialModal.tsx",children:(0,n.jsxs)(q.cZ,{size:"small","data-sentry-element":"DialogContent","data-sentry-source-file":"RevokeCredentialModal.tsx",children:[(0,n.jsx)(q.fK,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"RevokeCredentialModal.tsx",children:(0,n.jsxs)(q.$N,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"RevokeCredentialModal.tsx",children:["Revoke credential ",(0,n.jsx)("code",{className:"text-sm",children:null==s?void 0:s.description})]})}),(0,n.jsx)(q.P3,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"RevokeCredentialModal.tsx"}),(0,n.jsx)(q.VO,{"data-sentry-element":"DialogSection","data-sentry-source-file":"RevokeCredentialModal.tsx",children:(0,n.jsx)(q.Be,{"data-sentry-element":"DialogDescription","data-sentry-source-file":"RevokeCredentialModal.tsx",children:"This action is irreversible and requests made with these access keys will stop working."})}),(0,n.jsxs)(q.cN,{className:"flex justify-end gap-x-1","data-sentry-element":"DialogFooter","data-sentry-source-file":"RevokeCredentialModal.tsx",children:[(0,n.jsx)(z.z,{type:"outline",onClick:()=>a(),"data-sentry-element":"Button","data-sentry-source-file":"RevokeCredentialModal.tsx",children:"Cancel"}),(0,n.jsx)(z.z,{type:"danger",loading:i,onClick:async()=>{s&&l({id:s.id,projectRef:r})},"data-sentry-element":"Button","data-sentry-source-file":"RevokeCredentialModal.tsx",children:"Yes, revoke access keys"})]})]})})};var H=s(98715),Y=s(21463),$=s(43566);function J(e,t){var s=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return s<0?-1:s>0?1:s}var ee=s(28484),et=s(33378),es=s(18904),en=s(34814);let ea=e=>{let{description:t,id:s,created_at:a,access_key:r,onDeleteClick:l}=e,i=(0,M.Xo)(c.KA.STORAGE_ADMIN_WRITE,"*");return(0,n.jsxs)("tr",{className:"h-8 text-ellipsis group","data-sentry-component":"StorageCredItem","data-sentry-source-file":"StorageCredItem.tsx",children:[(0,n.jsx)("td",{children:(0,n.jsx)("span",{className:"text-foreground",children:t})}),(0,n.jsx)("td",{children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("span",{className:"text-ellipsis font-mono cursor-default",children:r}),(0,n.jsx)("span",{className:"w-24 text-right opacity-0 group-hover:opacity-100 transition-opacity",children:(0,n.jsx)(es.Z,{text:r,type:"default","data-sentry-element":"CopyButton","data-sentry-source-file":"StorageCredItem.tsx"})})]})}),(0,n.jsx)("td",{children:function(e){let t=function(e,t){(0,$.Z)(2,arguments);var s=(0,H.default)(e),n=(0,H.default)(t),a=J(s,n),r=Math.abs((0,Y.default)(s,n));s.setDate(s.getDate()-a*r);var l=Number(J(s,n)===-a),i=a*(r-l);return 0===i?0:i}(new Date,new Date(e));return 0===t?"Today":1===t?"".concat(t," day ago"):"".concat(t," days ago")}(a)}),(0,n.jsx)("td",{className:"text-right",children:i&&(0,n.jsxs)(en.h_,{children:[(0,n.jsx)(en.$F,{asChild:!0,children:(0,n.jsx)(z.z,{icon:(0,n.jsx)(ee.Z,{size:14,strokeWidth:1}),type:"text",className:"px-1.5 text-foreground-lighter hover:text-foreground"})}),(0,n.jsx)(en.AW,{className:"max-w-40",align:"end",children:(0,n.jsxs)(en.Xi,{className:"flex gap-1.5 ",onClick:e=>{e.preventDefault(),l(s)},children:[(0,n.jsx)(et.Z,{size:"14"}),"Revoke key"]})})]})})]})};var er=s(47256);let el=()=>{var e,t,s,a;let{ref:r}=(0,h.UO)(),l=(0,g.gY)(),{project:i,isLoading:u}=(0,g.d2)(),[R,_]=(0,x.useState)(!1),[D,I]=(0,x.useState)(!1),[A,Q]=(0,x.useState)(),B=(0,M.Xo)(c.KA.STORAGE_ADMIN_READ,"*"),K=(0,M.Xo)(c.KA.STORAGE_ADMIN_WRITE,"*"),{data:q}=(0,b.zR)({projectRef:r}),{data:V,error:G,isSuccess:H,isError:Y}=(0,k.k)({projectRef:r}),{data:$,isLoading:J}=E({projectRef:r},{enabled:B}),{mutate:ee,isLoading:et}=(0,w.l)({onSuccess:(e,t)=>{t.features&&en.reset({s3ConnectionEnabled:t.features.s3Protocol.enabled}),p.Am.success("Successfully updated storage settings")}}),es=y.Ry({s3ConnectionEnabled:y.O7()}),en=(0,m.cI)({resolver:(0,o.F)(es),defaultValues:{s3ConnectionEnabled:!1}}),el=null!==(a=null==q?void 0:null===(e=q.app_config)||void 0===e?void 0:e.protocol)&&void 0!==a?a:"https",ei=null==q?void 0:null===(t=q.app_config)||void 0===t?void 0:t.endpoint,eo=(null==$?void 0:$.data)&&$.data.length>0,ec=(0,er.Vp)(null!=r?r:"",el,ei),ed=async e=>r?V?void ee({projectRef:r,features:{...null==V?void 0:V.features,s3Protocol:{enabled:e.s3ConnectionEnabled}}}):console.error("Storage config is required"):console.error("Project ref is required");return(0,x.useEffect)(()=>{en.reset({s3ConnectionEnabled:null==V?void 0:V.features.s3Protocol.enabled})},[H]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Z.l0,{...en,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"S3Connection.tsx",children:(0,n.jsxs)("form",{id:"s3-connection-form",onSubmit:en.handleSubmit(ed),children:[(0,n.jsx)(N.p,{title:"S3 Connection",description:"Connect to your bucket using any S3-compatible service via the S3 protocol",docsUrl:"https://supabase.com/docs/guides/storage/s3/authentication","data-sentry-element":"FormHeader","data-sentry-source-file":"S3Connection.tsx"}),u?(0,n.jsx)(W.A,{}):l?(0,n.jsxs)(C.Z,{className:"!mb-0",children:[(0,n.jsx)(Z.Wi,{name:"s3ConnectionEnabled",control:en.control,render:e=>{let{field:t}=e;return(0,n.jsx)(L.E,{layout:"horizontal",className:"px-8 py-8 [&>*>label]:text-foreground",label:"Enable connection via S3 protocol",description:"Allow clients to connect to Supabase Storage via the S3 protocol",children:(0,n.jsx)(Z.NI,{children:(0,n.jsx)(F.r,{size:"large",checked:t.value,onCheckedChange:t.onChange,disabled:!H||t.disabled})})})}}),Y&&(0,n.jsx)("div",{className:"px-8 pb-8",children:(0,n.jsx)(v.Z,{subject:"Failed to retrieve storage configuration",error:G})}),(0,n.jsx)(T.Z,{className:"bg-border"}),(0,n.jsxs)("div",{className:"flex flex-col gap-y-4 py-8",children:[(0,n.jsx)(L.E,{layout:"horizontal",className:"px-8",label:"Endpoint",isReactForm:!1,children:(0,n.jsx)(O.I,{readOnly:!0,copy:!0,disabled:!0,value:ec})}),!u&&(0,n.jsx)(L.E,{layout:"horizontal",className:"px-8",label:"Region",isReactForm:!1,children:(0,n.jsx)(O.I,{className:"input-mono",copy:!0,disabled:!0,value:null==i?void 0:i.region})})]}),(0,n.jsx)(T.Z,{}),(0,n.jsxs)("div",{className:"flex items-center justify-between w-full gap-2 px-8 py-4",children:[K?(0,n.jsx)("div",{}):(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"You need additional permissions to update storage settings"}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(z.z,{type:"default",htmlType:"reset",onClick:()=>en.reset(),disabled:!en.formState.isDirty||!K||et,children:"Cancel"}),(0,n.jsx)(z.z,{type:"primary",htmlType:"submit",loading:et,disabled:!en.formState.isDirty||!K||et,children:"Save"})]})]})]}):(0,n.jsxs)(d.bZ,{variant:"warning",children:[(0,n.jsx)(P.aN,{}),(0,n.jsx)(d.Cd,{children:"Project is paused"}),(0,n.jsx)(d.X,{children:"To connect to your S3 bucket, you need to restore your project."}),(0,n.jsx)("div",{className:"mt-3 flex items-center space-x-2",children:(0,n.jsx)(z.z,{asChild:!0,type:"default",children:(0,n.jsx)(f(),{href:"/project/".concat(r),children:"Restore project"})})})]})]})}),(0,n.jsxs)("div",{children:[(0,n.jsx)(N.p,{title:"S3 Access Keys",description:"Manage your access keys for this project.",actions:(0,n.jsx)(X,{visible:R,onOpenChange:_}),"data-sentry-element":"FormHeader","data-sentry-source-file":"S3Connection.tsx"}),B?u?(0,n.jsx)(W.A,{}):l?(0,n.jsx)(n.Fragment,{children:J?(0,n.jsx)("div",{className:"p-4",children:(0,n.jsx)(W.A,{})}):(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsx)(j.Z,{head:[(0,n.jsx)(j.Z.th,{children:"Description"},""),(0,n.jsx)(j.Z.th,{children:"Access key ID"},""),(0,n.jsx)(j.Z.th,{children:"Created at"},""),(0,n.jsx)(j.Z.th,{},"actions")],body:eo?null===(s=$.data)||void 0===s?void 0:s.map(e=>(0,n.jsx)(ea,{created_at:e.created_at,access_key:e.access_key,description:e.description,id:e.id,onDeleteClick:()=>{Q(e),I(!0)}},e.id)):(0,n.jsx)(j.Z.tr,{children:(0,n.jsxs)(j.Z.td,{colSpan:4,className:"!rounded-b-md overflow-hidden",children:[(0,n.jsx)("p",{className:"text-sm text-foreground",children:"No access keys created"}),(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"There are no access keys associated with your project yet"})]})})})})}):(0,n.jsxs)(d.bZ,{variant:"warning",children:[(0,n.jsx)(P.aN,{}),(0,n.jsx)(d.Cd,{children:"Can't fetch S3 access keys"}),(0,n.jsx)(d.X,{children:"To fetch your S3 access keys, you need to restore your project."}),(0,n.jsx)(d.X,{children:(0,n.jsx)(z.z,{asChild:!0,type:"default",className:"mt-3",children:(0,n.jsx)(f(),{href:"/project/".concat(r),children:"Restore project"})})})]}):(0,n.jsx)(S.Z,{resourceText:"view this project's S3 access keys"})]}),(0,n.jsx)(U,{visible:D,selectedCredential:A,onClose:()=>{I(!1),Q(void 0)},"data-sentry-element":"RevokeCredentialModal","data-sentry-source-file":"S3Connection.tsx"})]})},ei=()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l._S,{"data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"storage.tsx",children:(0,n.jsxs)(l.tU,{"data-sentry-element":"ScaffoldHeader","data-sentry-source-file":"storage.tsx",children:[(0,n.jsx)(l.q7,{"data-sentry-element":"ScaffoldTitle","data-sentry-source-file":"storage.tsx",children:"Storage Settings"}),(0,n.jsx)(l.FW,{"data-sentry-element":"ScaffoldDescription","data-sentry-source-file":"storage.tsx",children:"Configure your project's storage settings"})]})}),(0,n.jsxs)(l._S,{className:"flex flex-col gap-10",bottomPadding:!0,"data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"storage.tsx",children:[(0,n.jsx)(i.cx,{"data-sentry-element":"StorageSettings","data-sentry-source-file":"storage.tsx"}),(0,n.jsx)(el,{"data-sentry-element":"S3Connection","data-sentry-source-file":"storage.tsx"})]})]});ei.getLayout=e=>(0,n.jsx)(a.Z,{children:(0,n.jsx)(r.Z,{title:"Settings",children:e})});var eo=ei},85573:function(e,t,s){"use strict";s.d(t,{I:function(){return u}});var n=s(97458),a=s(94122),r=s(52983),l=s(53355),i=s(21758),o=s(94997),c=s(99952);function d(e){let{icon:t,className:s}=e;return(0,n.jsx)("div",{className:(0,l.cn)("absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-foreground-light",s),"data-sentry-component":"InputIconContainer","data-sentry-source-file":"InputIconContainer.tsx",children:t})}let u=(0,r.forwardRef)((e,t)=>{let{copy:s,icon:u,reveal:f=!1,actions:x,onCopy:m,iconContainerClassName:p,containerClassName:y,...h}=e,[g,j]=(0,r.useState)("Copy"),[v,N]=(0,r.useState)(!0),S=(0,c.Z)("input"),C=[];return u&&C.push(S.with_icon),(0,n.jsxs)("div",{className:(0,l.cn)("relative",y),children:[(0,n.jsx)(i.I,{ref:t,...h,onCopy:m,value:f&&v?"**** **** **** ****":h.value,className:(0,l.cn)(...C,h.className)}),u&&(0,n.jsx)(d,{icon:u,className:p}),s||x?(0,n.jsxs)("div",{className:S.actions_container,children:[s&&!(f&&v)?(0,n.jsx)(o.z,{size:"tiny",type:"default",icon:(0,n.jsx)(a.Z,{size:16,className:"text-foreground-muted"}),onClick:()=>{var e,t;return e=h.value,void(null===(t=navigator.clipboard.writeText(e))||void 0===t||t.then(function(){j("Copied"),setTimeout(function(){j("Copy")},3e3),null==m||m()},function(){j("Failed to copy")}))},children:g}):null,f&&v?(0,n.jsx)(o.z,{size:"tiny",type:"default",onClick:function(){N(!1)},children:"Reveal"}):null,x&&x]}):null]})})}},function(e){e.O(0,[6665,3659,9557,588,7037,2383,6402,2132,8703,9910,5523,2967,4969,3862,441,6866,8058,3697,2224,8029,2732,5612,1961,8882,7080,171,1877,706,4331,9258,2769,7637,7422,9774,2888,179],function(){return e(e.s=6465)}),_N_E=e.O()}]);